-- Wait for game to fully load
repeat wait() until game:IsLoaded()

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

-- Check if this is an auto rejoin (persisted via getgenv)
if getgenv().AutoRejoinTriggered then
    -- Clear flag so it doesn’t repeat next manual join
    getgenv().AutoRejoinTriggered = nil

    -- ✅ Only runs after script-triggered rejoin
    local prompt
    repeat
        pcall(function()
            prompt = workspace:WaitForChild("Trophy", 5)
                      :WaitForChild("ProxHold", 5)
                      :WaitForChild("ProximityPrompt", 5)
        end)
        wait(0.5)
    until prompt

    -- Start firing the prompt repeatedly
    task.spawn(function()
        while true do
            wait(1.5)
            fireproximityprompt(prompt, 1, Enum.KeyCode.E, LocalPlayer)
        end
    end)
end

-- Optional: Wait a few seconds before auto-rejoining
task.delay(10, function()
    -- Set the rejoin flag
    getgenv().AutoRejoinTriggered = true

    -- Rejoin the same game
    TeleportService:Teleport(game.PlaceId, LocalPlayer)
end)
